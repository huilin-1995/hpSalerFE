'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _wptr = require('./wptr.1.1');

var _wptr2 = _interopRequireDefault(_wptr);

var _reactHammerjs = require('react-hammerjs');

var _reactHammerjs2 = _interopRequireDefault(_reactHammerjs);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var emptyEvents = {
  onPanStart: undefined,
  onPan: undefined,
  onPanEnd: undefined
};

var PullToRefresh = function (_React$Component) {
  (0, _inherits3["default"])(PullToRefresh, _React$Component);

  function PullToRefresh() {
    (0, _classCallCheck3["default"])(this, PullToRefresh);
    return (0, _possibleConstructorReturn3["default"])(this, _React$Component.apply(this, arguments));
  }

  PullToRefresh.prototype.componentWillMount = function componentWillMount() {
    this.webPullToRefresh = (0, _wptr2["default"])();
  };

  PullToRefresh.prototype.componentDidMount = function componentDidMount() {
    var props = this.props;
    var refs = this.refs;

    this.webPullToRefresh.init({
      contentEl: refs.content,
      containerEl: refs.container,
      ptrEl: refs.ptr,
      prefixCls: props.prefixCls,
      distanceToRefresh: props.distanceToRefresh,
      loadingFunction: props.loadingFunction,
      resistance: props.resistance
    });
  };

  PullToRefresh.prototype.render = function render() {
    var _props = this.props;
    var prefixCls = _props.prefixCls;
    var children = _props.children;
    var icon = _props.icon;
    var loading = _props.loading;
    var disabled = _props.disabled;
    var _props$className = _props.className;
    var className = _props$className === undefined ? '' : _props$className;
    var style = _props.style;
    var contentStyle = _props.contentStyle;
    var _props$contentClassNa = _props.contentClassName;
    var contentClassName = _props$contentClassNa === undefined ? '' : _props$contentClassNa;
    var _props$hammerOptions = _props.hammerOptions;
    var hammerOptions = _props$hammerOptions === undefined ? {} : _props$hammerOptions;

    var events = disabled ? emptyEvents : this.webPullToRefresh.events;
    return _react2["default"].createElement(
      'div',
      { className: className + ' ' + prefixCls, style: style, ref: 'container' },
      _react2["default"].createElement(
        'div',
        { ref: 'ptr', className: prefixCls + '-ptr' },
        _react2["default"].createElement(
          'div',
          { className: prefixCls + '-ptr-icon' },
          icon
        ),
        _react2["default"].createElement(
          'div',
          { className: prefixCls + '-ptr-loading' },
          loading
        )
      ),
      _react2["default"].createElement(
        _reactHammerjs2["default"],
        (0, _extends3["default"])({ direction: 'DIRECTION_ALL' }, events, { options: hammerOptions }),
        _react2["default"].createElement(
          'div',
          {
            ref: 'content',
            className: prefixCls + '-content ' + contentClassName,
            style: contentStyle
          },
          children
        )
      )
    );
  };

  return PullToRefresh;
}(_react2["default"].Component);

PullToRefresh.propTypes = {
  loadingFunction: _react.PropTypes.func.isRequired,
  icon: _react.PropTypes.element,
  prefixCls: _react.PropTypes.string,
  loading: _react.PropTypes.element,
  disabled: _react.PropTypes.bool,
  className: _react.PropTypes.string,
  style: _react.PropTypes.object,
  contentClassName: _react.PropTypes.string,
  contentStyle: _react.PropTypes.object,
  distanceToRefresh: _react.PropTypes.number,
  resistance: _react.PropTypes.number,
  children: _react.PropTypes.any,
  hammerOptions: _react.PropTypes.object
};
PullToRefresh.defaultProps = {
  prefixCls: 'rmc-pull-to-refresh'
};
exports["default"] = PullToRefresh;
module.exports = exports['default'];